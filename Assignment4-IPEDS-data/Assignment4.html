<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Rios">

<title>Assignment 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Assignment4_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment4_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment4_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment4_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="Assignment4_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="Assignment4_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Rios </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>echo <span class="ot">=</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vtable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: kableExtra</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">'college_expenses_and_enrollment.Rds'</span>) </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vtable</span>(col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>col</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Name </th>
   <th style="text-align:left;"> Class </th>
   <th style="text-align:left;"> Label </th>
   <th style="text-align:left;"> Values </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> UNITID </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> College ID </td>
   <td style="text-align:left;"> Num: 100654 to 491118 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> STABBR </td>
   <td style="text-align:left;"> factor </td>
   <td style="text-align:left;"> State </td>
   <td style="text-align:left;"> 'AK' 'AL' 'AR' 'AS' 'AZ' and more </td>
  </tr>
  <tr>
   <td style="text-align:left;"> type </td>
   <td style="text-align:left;"> factor </td>
   <td style="text-align:left;"> College Type (NP = Nonprofit) </td>
   <td style="text-align:left;"> 'For-Profit 2-Year' 'For-Profit 4-Year' 'Private NP 2-Year' 'Private NP 4-Year' 'Public 2-Year' and more </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total.Income </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Total Income </td>
   <td style="text-align:left;"> Num: 6067 to 9703300000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total.Expenses </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Total Expenses </td>
   <td style="text-align:left;"> Num: 4600 to 8629847000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tuition </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Tuition (Income) </td>
   <td style="text-align:left;"> Num: 0 to 1753736000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Federal </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Federal Support (Income) </td>
   <td style="text-align:left;"> Num: 0 to 1071432208 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> State </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> State Support (Income) </td>
   <td style="text-align:left;"> Num: 0 to 909496000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Local </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Local Support (Income) </td>
   <td style="text-align:left;"> Num: 0 to 386724142 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Private </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Private Support (Income) </td>
   <td style="text-align:left;"> Num: -246016 to 1568865000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sales </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Sales (Income) </td>
   <td style="text-align:left;"> Num: -1073664 to 8471746000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Research </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Research (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 2910863000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Public.Service </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Public Service (Expense) </td>
   <td style="text-align:left;"> Num: -32 to 807399000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Student.Services </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Student Services (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 284363000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Instruction </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Instruction (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 2611938000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Academic.Support </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Academic Support (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 919577000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Other </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Other Expenses </td>
   <td style="text-align:left;"> Num: -1 to 5543912000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Institution.Name </td>
   <td style="text-align:left;"> character </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total.Enrollment </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;"> Num: 9 to 131629 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Full.Time.Enrollment </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;"> Num: 0 to 131629 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Undergraduate.Enrollment </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;"> Num: 0 to 103711 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:kableExtra':

    group_rows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I first wanted to find if there was a coorelation between the tuition for a school and the money they spend back. Student Services seemed like a good place to start.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> col <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TuitionPer =</span> Tuition <span class="sc">/</span> Total.Enrollment) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ServicesPer =</span> Student.Services <span class="sc">/</span> Total.Enrollment)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(col, <span class="fu">aes</span>(<span class="at">x =</span> TuitionPer, <span class="at">y =</span> <span class="st">`</span><span class="at">ServicesPer</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">100000</span>, <span class="at">suffix =</span> <span class="st">'K'</span>)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">20000</span>) <span class="sc">+</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">175000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for y is already present.
Adding another scale for y, which will replace the existing scale.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 523 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 523 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_smooth()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># there ended up being a major outlier in Tuition per student with 'Ultimate Medical Academy' with about 1,000,000 in tuition which was interesting, but I wanted to key in on where most of the data was So I limited the axis </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ lubridate 1.9.2     ✔ tibble    3.2.1
✔ purrr     1.0.1     ✔ tidyr     1.3.0
✔ readr     2.1.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ readr::col_factor() masks scales::col_factor()
✖ purrr::discard()    masks scales::discard()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::group_rows() masks kableExtra::group_rows()
✖ dplyr::lag()        masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>col <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TuitionPer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,771 × 23
   UNITID STABBR type  Total.Income Total.Expenses Tuition Federal  State  Local
    &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 441371 FL     Priv…    373780643      197772296  2.80e8  9.37e7 2.46e4 226500
 2 231068 VT     Priv…     61030630      141173242  4.70e7  0      0           0
 3 443331 CA     For-…    206190838       73750083  1.91e8  1.15e7 3.33e6      0
 4 212975 PA     Priv…     23216000       21474000  2.25e7  5.26e5 1.62e5      0
 5 366289 CA     For-…     16374633        7505723  1.23e7  4.11e6 0           0
 6 209205 OR     For-…      8880974        3104282  6.68e6  2.20e6 0           0
 7 486026 NY     Priv…      9357145        6563592  4.89e6  8.16e5 1.92e5      0
 8 143978 IL     Priv…    100708464       48155429  9.37e7  9.35e5 4.02e5      0
 9 126164 CO     For-…      1108702         415288  8.81e5  2.28e5 0           0
10 447801 CA     For-…      2446368         956148  2.29e6  0      0           0
# ℹ 4,761 more rows
# ℹ 14 more variables: Private &lt;dbl&gt;, Sales &lt;dbl&gt;, Research &lt;dbl&gt;,
#   Public.Service &lt;dbl&gt;, Student.Services &lt;dbl&gt;, Instruction &lt;dbl&gt;,
#   Academic.Support &lt;dbl&gt;, Other &lt;dbl&gt;, Institution.Name &lt;chr&gt;,
#   Total.Enrollment &lt;dbl&gt;, Full.Time.Enrollment &lt;dbl&gt;,
#   Undergraduate.Enrollment &lt;dbl&gt;, TuitionPer &lt;dbl&gt;, ServicesPer &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding the outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I wanted to then focus in on a more specific variable, the type of colleges and their corresponding average student services expenses </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(col, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(type),<span class="at">y=</span>Student.Services)) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">100000000</span>, <span class="at">suffix =</span> <span class="st">'M'</span>)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Type'</span>, <span class="at">y =</span> <span class="st">'Student Service Expenses'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this graph turned out to be very interesting considering the difference between for profits and non-profits/public </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># next I want to look at the student resources each type of college spends per student, a more broad view than just student services </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># student services, instruction expenses, and academic support seem to be the best variables to include</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>expenses <span class="ot">&lt;-</span> col <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg =</span> (Student.Services <span class="sc">+</span> Instruction <span class="sc">+</span> Academic.Support) <span class="sc">/</span> Total.Enrollment) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>expenses_avg <span class="ot">&lt;-</span> expenses <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg =</span> <span class="fu">mean</span>(avg))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>expenses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,771 × 24
# Groups:   type [6]
   UNITID STABBR type  Total.Income Total.Expenses Tuition Federal  State  Local
    &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 100654 AL     Publ…    159374242      103277451  4.65e7  4.52e7 4.22e7 0     
 2 100663 AL     Publ…   2958953209     2693408556  2.09e8  3.85e8 2.83e8 2.35e6
 3 100690 AL     Priv…      8318086        3558638  6.60e6  9.04e5 0      0     
 4 100706 AL     Publ…    225584462      194717488  6.24e7  8.04e7 5.20e7 0     
 5 100724 AL     Publ…    133050206       89443721  4.53e7  2.84e7 4.66e7 0     
 6 100751 AL     Publ…   1176652071      904802129  4.83e8  7.20e7 1.86e8 1.02e6
 7 100760 AL     Publ…     20045797       13917163  2.12e6  5.60e6 1.23e7 0     
 8 100812 AL     Publ…     37301196       25457379  1.54e7  5.75e6 1.55e7 0     
 9 100830 AL     Publ…     91827335       59084528  3.42e7  1.02e7 3.01e7 1.49e5
10 100858 AL     Publ…   1055964649      923953101  4.17e8  1.02e8 2.40e8 2.64e6
# ℹ 4,761 more rows
# ℹ 15 more variables: Private &lt;dbl&gt;, Sales &lt;dbl&gt;, Research &lt;dbl&gt;,
#   Public.Service &lt;dbl&gt;, Student.Services &lt;dbl&gt;, Instruction &lt;dbl&gt;,
#   Academic.Support &lt;dbl&gt;, Other &lt;dbl&gt;, Institution.Name &lt;chr&gt;,
#   Total.Enrollment &lt;dbl&gt;, Full.Time.Enrollment &lt;dbl&gt;,
#   Undergraduate.Enrollment &lt;dbl&gt;, TuitionPer &lt;dbl&gt;, ServicesPer &lt;dbl&gt;,
#   avg &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(expenses, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> avg)) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">100000</span>, <span class="at">suffix =</span> <span class="st">'K'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 516 rows containing missing values (`position_stack()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment4_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Type'</span>, <span class="at">y =</span> <span class="st">'Student Service Expenses'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] "Type"

$y
[1] "Student Service Expenses"

attr(,"class")
[1] "labels"</code></pre>
</div>
</div>
<p>The graph confirms the previous findings, but also shows that private Non-profits far and away spend the most money per student of the types of colleges.</p>
<p>From this point I’m interested in finding the best return on value for colleges by type, as we know the tuition varies vastly by the type of college and this should be accounted for.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Because the previous graph didn't account for tuition cost, I'll shift focus to this now</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>tuition_to_value <span class="ot">&lt;-</span> expenses <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tvalue =</span> avg<span class="sc">/</span>TuitionPer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tuition_to_value <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">tvalue =</span> <span class="fu">mean</span>(tvalue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  type              tvalue
  &lt;fct&gt;              &lt;dbl&gt;
1 For-Profit 2-Year     NA
2 For-Profit 4-Year     NA
3 Private NP 2-Year     NA
4 Private NP 4-Year     NA
5 Public 2-Year         NA
6 Public 4-Year         NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tuition_to_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,771 × 25
# Groups:   type [6]
   UNITID STABBR type  Total.Income Total.Expenses Tuition Federal  State  Local
    &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 100654 AL     Publ…    159374242      103277451  4.65e7  4.52e7 4.22e7 0     
 2 100663 AL     Publ…   2958953209     2693408556  2.09e8  3.85e8 2.83e8 2.35e6
 3 100690 AL     Priv…      8318086        3558638  6.60e6  9.04e5 0      0     
 4 100706 AL     Publ…    225584462      194717488  6.24e7  8.04e7 5.20e7 0     
 5 100724 AL     Publ…    133050206       89443721  4.53e7  2.84e7 4.66e7 0     
 6 100751 AL     Publ…   1176652071      904802129  4.83e8  7.20e7 1.86e8 1.02e6
 7 100760 AL     Publ…     20045797       13917163  2.12e6  5.60e6 1.23e7 0     
 8 100812 AL     Publ…     37301196       25457379  1.54e7  5.75e6 1.55e7 0     
 9 100830 AL     Publ…     91827335       59084528  3.42e7  1.02e7 3.01e7 1.49e5
10 100858 AL     Publ…   1055964649      923953101  4.17e8  1.02e8 2.40e8 2.64e6
# ℹ 4,761 more rows
# ℹ 16 more variables: Private &lt;dbl&gt;, Sales &lt;dbl&gt;, Research &lt;dbl&gt;,
#   Public.Service &lt;dbl&gt;, Student.Services &lt;dbl&gt;, Instruction &lt;dbl&gt;,
#   Academic.Support &lt;dbl&gt;, Other &lt;dbl&gt;, Institution.Name &lt;chr&gt;,
#   Total.Enrollment &lt;dbl&gt;, Full.Time.Enrollment &lt;dbl&gt;,
#   Undergraduate.Enrollment &lt;dbl&gt;, TuitionPer &lt;dbl&gt;, ServicesPer &lt;dbl&gt;,
#   avg &lt;dbl&gt;, tvalue &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># want to group the types into categories together </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>tuition_to_value <span class="ot">&lt;-</span> tuition_to_value <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">college_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"*public*"</span>, type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"*public*"</span>, type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Public"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"*private*"</span>, type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"*private*"</span>, type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Private Non-Profit"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"*for-profit*"</span>, type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"*for-profit*"</span>, type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"For-Profit"</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">college_category =</span> <span class="fu">factor</span>(college_category, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Public"</span>, <span class="st">"Private Non-Profit"</span>, <span class="st">"For-Profit"</span>)))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tuition_to_value, <span class="fu">aes</span>(<span class="at">x =</span> tvalue, <span class="at">y =</span> type, <span class="at">fill =</span> college_category)) <span class="sc">+</span> </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>) <span class="sc">+</span> </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..x.., <span class="dv">2</span>)), <span class="at">hjust =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Student Resource spending per Tuition Dollar"</span>, <span class="at">y =</span> <span class="st">"Type of College"</span>, <span class="at">title =</span> <span class="st">"What Types of Colleges Offer the Best Value for Money?"</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'Public'</span><span class="ot">=</span><span class="st">'green3'</span>,<span class="st">'Private Non-Profit'</span><span class="ot">=</span><span class="st">'yellow3'</span>,<span class="st">'For-Profit'</span><span class="ot">=</span><span class="st">'tomato'</span>)) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"College Type"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..x..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(x)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 527 rows containing non-finite values (`stat_summary()`).
Removed 527 rows containing non-finite values (`stat_summary()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This isn't at the bottom but I chose to make this the more presentable graph</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tried to add dollar sign to labels but couldn't quite figure it out</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For every dollar of tuition spent this is the amount the college spends on student resources in return. The higher the ratio, the better. It looks like Public 2-years offer the best value with public 4-years at second best. Notably we find for-profit schools offering the worst value.</p>
<p>Next I want to see this relationship as a plot graph with a trendline by college type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tuition_to_value, <span class="fu">aes</span>(<span class="at">x =</span> TuitionPer, <span class="at">y =</span> avg, <span class="at">color =</span> type)) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250000</span>) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">200000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 520 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 520 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment4_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>